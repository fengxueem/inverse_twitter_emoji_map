<!DOCTYPE html>
<html style="height: 100%">

<head>
    <meta charset="utf-8">
    <title>Twitter-Emoji-Map</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/dot-luv/jquery-ui.css" />
    <style>
    #slider-range {
        width: 400px;
    }

    #slider-range,
    #time {
        margin: 10px;
        display: block;
    }
    </style>
    <script>
    $(document).ready(function() {
        $("button").click(function() {
            $.get("http://localhost:3000/countries", { start: startTime, end: endTime }, function(data) {
                myChart.setOption({
                    series: [{
                        data: data
                    }]
                });
            });
        });
    });
    </script>
</head>

<body style="height: 100%; margin: 0">
    <div id="container" style="height: 100%"></div>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts-all-3.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
    <script type="text/javascript">
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    var app = {};
    option = null;
    option = {
        title: {
            text: 'World Tweets',
            //            subtext: 'from United Nations, Total population, both sexes combined, as of 1 July (thousands)',
            //            sublink: 'http://esa.un.org/wpp/Excel-Data/population.htm',
            left: 'center',
            top: 'top'
        },
        tooltip: {
            trigger: 'item',
            formatter: function(params) {
                //                var value = (params.value + '').split('.');
                //                value = value[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g, '$1,');
                //                + '.' + value[1];
                var value = params.value;
                return params.seriesName + '<br/>' + params.name + ' : ' + value;
            }
        },
        toolbox: {
            show: true,
            orient: 'vertical',
            left: 'right',
            top: 'center',
            feature: {
                dataView: { readOnly: false },
                restore: {},
                saveAsImage: {}
            }
        },
        visualMap: {
            min: 0,
            max: 10,
            text: ['High', 'Low'],
            realtime: false,
            calculable: true,
            inRange: {
                color: ['lightskyblue', 'yellow', 'orangered']
            }
        },
        series: [{
            name: 'World Tweets',
            type: 'map',
            mapType: 'world',
            roam: true,
            itemStyle: {
                emphasis: { label: { show: true } }
            },
            data: []

        }]
    };;
    if (option && typeof option === "object") {
        myChart.setOption(option, true);
    }
    </script>
    <div id="slider-range"></div>
    <span id="time"></span>
    <button>Confirm</button>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    $("#slider-range").slider({
        range: true,
        min: 0,
        max: 1439,
        values: [540, 1020],
        slide: slideTime
    });

    function slideTime(event, ui) {
        var val0 = $("#slider-range").slider("values", 0),
            val1 = $("#slider-range").slider("values", 1),
            // minutes0 = parseInt(val0 % 60, 10),
            hours0 = parseInt(val0 / 60 % 24, 10),
            // minutes1 = parseInt(val1 % 60, 10),
            hours1 = parseInt(val1 / 60 % 24, 10);

        //        startTime = getTime(hours0, minutes0);
        //        endTime = getTime(hours1, minutes1);
        startTime = 24 - hours0
        endTime = 23 - hours1;
        $("#time").text(startTime + ' hours ago - ' + endTime + " hours ago");
    }

    function getTime(hours, minutes) {
        var time = null;
        minutes = minutes + "";
        if (hours < 12) {
            time = "AM";
        } else {
            time = "PM";
        }
        if (hours == 0) {
            hours = 12;
        }
        if (hours > 12) {
            hours = hours - 12;
        }
        if (minutes.length == 1) {
            minutes = "0" + minutes;
        }
        return hours + ": " + minutes + " " + time;
    }
    slideTime();
    </script>
</body>

</html>